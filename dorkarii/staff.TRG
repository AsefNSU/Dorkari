TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER update_staff_count\nAFTER INSERT ON Staff\nFOR EACH ROW\nBEGIN\n    -- Update total active staff count\n    UPDATE Branch\n    SET total_staff_active = (\n        SELECT COUNT(*) \n        FROM Staff \n        WHERE Staff.branch_id = NEW.branch_id AND Staff.active_status = \'active\'\n    ),\n    total_staff_inactive = (\n        SELECT COUNT(*) \n        FROM Staff \n        WHERE Staff.branch_id = NEW.branch_id AND Staff.active_status = \'inactive\'\n    )\n    WHERE Branch.branch_id = NEW.branch_id;\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER update_working_days\nBEFORE UPDATE ON Staff\nFOR EACH ROW\nBEGIN\n    IF NEW.attendance = \'Present\' AND OLD.attendance = \'Absent\' THEN\n        SET NEW.working_for_days = OLD.working_for_days + 1;\n    END IF;\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER update_staff_status\nAFTER UPDATE ON Staff\nFOR EACH ROW\nBEGIN\n    -- If staff status is updated, recalculate counts\n    UPDATE Branch\n    SET total_staff_active = (\n        SELECT COUNT(*) \n        FROM Staff \n        WHERE Staff.branch_id = NEW.branch_id AND Staff.active_status = \'active\'\n    ),\n    total_staff_inactive = (\n        SELECT COUNT(*) \n        FROM Staff \n        WHERE Staff.branch_id = NEW.branch_id AND Staff.active_status = \'inactive\'\n    )\n    WHERE Branch.branch_id = NEW.branch_id;\nEND'
sql_modes=1098907648 1098907648 1098907648
definers='root@localhost' 'root@localhost' 'root@localhost'
client_cs_names='utf8mb4' 'utf8mb4' 'utf8mb4'
connection_cl_names='utf8mb4_unicode_ci' 'utf8mb4_unicode_ci' 'utf8mb4_unicode_ci'
db_cl_names='utf8mb4_general_ci' 'utf8mb4_general_ci' 'utf8mb4_general_ci'
created=1741983625847743 1741982718834739 1741983656839642
